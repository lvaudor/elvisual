---
title: "elvisual"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{elvisual}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(elvisual)
```

Les fiches de métadonnées ont été exportées dans un dossier.

```{r data_dir}
data_dir="../data-raw/OHM_metadata" 
```

# Récupération des données depuis les fichiers .xml

On récupère les informations qu'on formatte dans un tableau. Les informations sont principalement récupérées par `el_data()`:

```{r general_metadata}
data=el_data(data_dir)
```

Si l'on veut récupérer les catégories:

```{r categories}
categories=el_categories(data_dir)
```

et si l'on veut un tableau formatté en une ligne = une fiche:

```{r data_summary}
data_summary=el_data_summary(data)
```


# Nuages de mots

On récupère une table des fréquences de mots-clés avec `el_freq_keywords()`:

```{r keywords}
freq_keywords=el_freq_keywords(data)
head(freq_keywords)
```

```{r wordcloud, fig.width=8,fig.height=6}
freq_keywords=el_freq_keywords(data) %>% 
  dplyr::filter(freq>2)

el_wordcloud(freq_keywords,
             keywords_to_remove=c("OHM VR","Rhône"))
```

```{r FREE_wordcloud, fig.width=8,fig.height=6}
freq_keywords_FREE=el_freq_keywords(data) %>%
  dplyr::filter(type=="FREE", freq>1)

el_wordcloud(freq_keywords_FREE,
             keywords_to_remove=c("OHM VR","Rhône"))
```


# Graphes de relations

On peut construire des graphes de relations entre les entités (personnes ou organisations) à partir des données. `el_graph_data()` permet de construire les données nécessaires, `el_graph()` permet de tracer le graphe.


```{r graph_personnes, fig.height=8, fig.width=8, warning=FALSE, message=FALSE}
graph_data_personnes=el_graph_data(data,nodetype="personne")
el_graph(graph_data_personnes, shorten_name=TRUE)
```


```{r graph_organisations, fig.height=8, fig.width=8, warning=FALSE, message=FALSE}
graph_data_organisations=el_graph_data(data,nodetype="organisation")
el_graph(graph_data_organisations)
```


# Vue temporelle


```{r}
time_table=el_time_table(data)
```

```{r time_line,fig.width=6,fig.height=4, warning=FALSE, message=FALSE}
el_time_line(time_table)
```


```{r time_hist, echo=FALSE,fig.width=6,fig.height=4, warning=FALSE, message=FALSE}
el_time_hist(time_table)
```

```{r time_duration,fig.width=6,fig.height=4, warning=FALSE, message=FALSE}
el_time_duration(time_table)
```


# Carte


```{r map, warning=FALSE, message=FALSE}
map_data=el_map_data(data)
```

Pour une carte statique:

```{r plot_map, warning=FALSE, message=FALSE}
el_map(map_data, mode="plot")
```

Pour une carte interactive :

```{r view_map, warning=FALSE, message=FALSE}
el_map(map_data, mode="view")
```

